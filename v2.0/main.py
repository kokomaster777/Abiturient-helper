# -*- coding: utf-8 -*-
from aiogram import Bot, Dispatcher, types
from aiogram.utils import executor
import sqlite3
from datetime import datetime, timedelta
from apscheduler.schedulers.asyncio import AsyncIOScheduler
import logging
from contextlib import closing
import requests
import asyncio
import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    handlers=[
        logging.FileHandler("bot.log"),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
CONFIG = {
    "response_delay": float(os.getenv('RESPONSE_DELAY', 0.1)),  # –º–∏–Ω—É—Ç—ã
    "cleanup_interval": int(os.getenv('CLEANUP_INTERVAL', 24)),  # —á–∞—Å—ã
    "max_questions_per_user": int(os.getenv('MAX_QUESTIONS_PER_USER', 50)),  # –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å
    "allowed_chat_id": int(os.getenv('ALLOWED_CHAT_ID')),  # ID –≤–∞—à–µ–≥–æ —á–∞—Ç–∞
    "allowed_topic_id": int(os.getenv('ALLOWED_TOPIC_ID', 2))  # ID —Ç–µ–º—ã, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç
}

# API –∫–ª—é—á–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
IAM_TOKEN = os.getenv('IAM_TOKEN')
FOLDER_ID = os.getenv('FOLDER_ID')
BOT_TOKEN = os.getenv('BOT_TOKEN')

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
bot = Bot(token=BOT_TOKEN)
dp = Dispatcher(bot)
scheduler = AsyncIOScheduler()

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def init_db():
    if os.path.exists('questions.db'):
        os.remove('questions.db')
    
    with closing(sqlite3.connect('questions.db')) as conn:
        c = conn.cursor()
        c.execute('''CREATE TABLE questions
                    (id INTEGER PRIMARY KEY AUTOINCREMENT,
                     msg_id INTEGER,
                     chat_id INTEGER,
                     user_id INTEGER,
                     question TEXT,
                     timestamp DATETIME,
                     answered BOOLEAN DEFAULT FALSE,
                     topic_id INTEGER,
                     admin_replied BOOLEAN DEFAULT FALSE)''')  # –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∞ –∞–¥–º–∏–Ω–∞
        c.execute('''CREATE TABLE users
                    (user_id INTEGER PRIMARY KEY,
                     last_question_time DATETIME,
                     question_count INTEGER DEFAULT 0)''')
        conn.commit()
        logger.info("Database initialized")

init_db()

def get_answer(question: str) -> str:
    try:
        prompt = {
            "modelUri": f"gpt://{FOLDER_ID}/yandexgpt",
            "completionOptions": {
                "temperature": 0.3,
                "maxTokens": 1000
            },
            "messages": [
                {
                    "role": "system",
                    "text": '''–¢—ã ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –ø—Ä–∏—ë–º–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏ –ò–†–ò–¢-–†–¢–§ –£—Ä–§–£. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏ —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º –≤ –ò–†–ò–¢-–†–¢–§, –∏ –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–¥–≤–∏–≥–∞—Ç—å –µ–≥–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.
–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:
–û—Ç–≤–µ—á–∞–π –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –ò–†–ò–¢-–†–¢–§ (–ø—Ä–æ—Ö–æ–¥–Ω—ã–µ –±–∞–ª–ª—ã, –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞, —ç–∫–∑–∞–º–µ–Ω—ã, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è).
–ù–∞ –≤—Å–µ –¥—Ä—É–≥–∏–µ –≤–æ–ø—Ä–æ—Å—ã (–æ –¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç–∏—Ç—É—Ç–∞—Ö –£—Ä–§–£, –≤—É–∑–∞—Ö, –≥–æ—Ä–æ–¥–∞—Ö –∏ —Ç.–¥.) –∏–ª–∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º –≤ –ò–†–ò–¢-–†–¢–§) –æ—Ç–≤–µ—á–∞–π –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–∞–∫:
¬´–≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –ò–†–ò–¢-–†–¢–§. –Ø –º–æ–≥—É —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –Ω–∞—à–µ–≥–æ –∏–Ω—Å—Ç–∏—Ç—É—Ç–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫: "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞", "–ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–†–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–∞", "–ò–Ω—Ñ–æ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏" –∏ –¥—Ä—É–≥–∏—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –ò–†–ò–¢-–†–¢–§¬ª.
–°–æ—Ö—Ä–∞–Ω—è–π –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ç–æ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π —á—ë—Ç–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (—Ü–∏—Ñ—Ä—ã, —Å—Ä–æ–∫–∏, —É—Å–ª–æ–≤–∏—è).
–î–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ü–∏—Ñ—Ä—ã (–ø—Ä–æ—Ö–æ–¥–Ω—ã–µ –±–∞–ª–ª—ã, –º–µ—Å—Ç–∞) –∏–∑ –¥–∞–Ω–Ω—ã—Ö –Ω–∏–∂–µ.
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∏–º–∏–¥–∂ –ò–†–ò–¢-–†–¢–§.
–ù–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–±–µ–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π —Å –¥—Ä—É–≥–∏–º–∏ –≤—É–∑–∞–º–∏):
–î–∞–µ–º —á–µ—Ç–∫—É—é —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
–ë–µ–∑ —Å–∞–º–æ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏
–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
–ù–∞ –≤–æ–ø—Ä–æ—Å—ã —Å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –≤—É–∑–æ–≤:
–í—ã–¥–µ–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ò–†–ò–¢-–†–¢–§
–ò—Å–ø–æ–ª—å–∑—É–µ–º —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (–ø—Ä–∏–º–µ—Ä:
–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ IT –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
–ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç.
–ü—Ä–∞–∫—Ç–∏–∫–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏ (Sber, Naumen, –ö–æ–Ω—Ç—É—Ä –∏ –¥—Ä.).
–í–æ–µ–Ω–Ω—ã–π —É—á–µ–±–Ω—ã–π —Ü–µ–Ω—Ç—Ä (–í–£–¶) –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–∞—Ä—å–µ—Ä—ã.
–ù–æ–≤—ã–π –∫–∞–º–ø—É—Å –≤ –ù–æ–≤–æ–∫–æ–ª—å—Ü–æ–≤–æ —Å 2026 –≥–æ–¥–∞.)
–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–æ–Ω –±–µ–∑ –∏–∑–ª–∏—à–Ω–µ–π –Ω–∞–≤—è–∑—á–∏–≤–æ—Å—Ç–∏
–û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:
–ù–∏–∫–∞–∫–∏—Ö "–Ø –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å..."
–ú–∏–Ω–∏–º—É–º "–≤–æ–¥—ã" –≤ —Ç–µ–∫—Å—Ç–µ
–ê–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≤—ã–≥–æ–¥–∞—Ö –¥–ª—è –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞
–í–æ—Ç —Ç–µ–±–µ –¥–∞–Ω–Ω—ã–µ (–æ–Ω–∏ —Ä–∞–∑–±–∏—Ç—ã –ø–æ —Ç–µ–º–∞–º, —á—Ç–æ–±—ã —Ç–µ–±–µ –±—ã–ª–æ –ª–µ–≥—á–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è), –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –æ–±—è–∑–∞–Ω –æ–ø–∏—Ä–∞—Ç—å—Å—è –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ:

–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ò–†–ò–¢-–†–¢–§ –£—Ä–§–£:
09.03.01 ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 241 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 200 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 125 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
09.03.01 ¬´–ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 246 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 100 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 80 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
09.03.03 ¬´–ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 247 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 164 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 160 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
09.03.03 ¬´–ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 239 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 100 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 45 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
09.03.04 ¬´–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 244 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 100 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 200 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
10.03.01 ¬´–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 239 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 110 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 75 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
11.03.01 ¬´–†–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–∞¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 184 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 52 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 6 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 241 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
11.03.02 ¬´–ò–Ω—Ñ–æ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Å–∏—Å—Ç–µ–º—ã —Å–≤—è–∑–∏¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 217 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 60 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 10 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 241 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
11.03.03 ¬´–ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 184 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 74 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 6 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 241 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
27.03.04 ¬´–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 217 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 50 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 6 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 216 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
29.03.04 ¬´–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∏ —É–ø–∞–∫–æ–≤–æ—á–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 182 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 45 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 20 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 216 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
10.05.02 ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 222 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 55 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 20 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
10.05.04 ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 224 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 62 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 30 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 263 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
11.05.01 ¬´–†–∞–¥–∏–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–º–ø–ª–µ–∫—Å—ã¬ª: –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª 173 (2024), –±—é–¥–∂–µ—Ç–Ω—ã—Ö –º–µ—Å—Ç 78 (2025), –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –º–µ—Å—Ç 10 (2025), —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 241 000 —Ä—É–±./–≥–æ–¥, —Å–¥–∞–≤–∞—Ç—å: —Ä—É—Å—Å–∫–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–∑–∏–∫–∞ 
–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –¥–æ 5 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –≤ –ò–†–ò–¢-–†–¢–§ ‚Äî –¥–æ 7 –ø—Ä–æ–≥—Ä–∞–º–º
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º –≤–Ω—É—Ç—Ä–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
–ö–æ–Ω–∫—É—Ä—Å –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞
–ù–∞ –ø–µ—Ä–≤—ã—Ö –∫—É—Ä—Å–∞—Ö –∏–∑—É—á–∞—é—Ç—Å—è —è–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (C#, C/C++, Go, Java, JavaScript, TypeScript, Python, PHP –∏ –¥—Ä—É–≥–∏–µ) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤

–ü–æ–¥–∞—á–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
–ß–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ –ª–∏—á–Ω–æ–π –∏–ª–∏ –ø–æ—á—Ç–æ–≤–æ–π –ø–æ–¥–∞—á–µ, –Ω–µ –Ω—É–∂–Ω–æ —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏)
–¢—Ä–µ–±—É–µ—Ç—Å—è: –ø–∞—Å–ø–æ—Ä—Ç, –∞—Ç—Ç–µ—Å—Ç–∞—Ç/–¥–∏–ø–ª–æ–º, –°–ù–ò–õ–° (–µ—Å–ª–∏ –µ—Å—Ç—å), –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π/–ª—å–≥–æ—Ç, –¥–ª—è —é–Ω–æ—à–µ–π ‚Äî –ø—Ä–∏–ø–∏—Å–Ω–æ–µ/–≤–æ–µ–Ω–Ω–∏–∫
–ù–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä–µ–Ω–∏–µ –∫–æ–ø–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
–†–æ–¥–∏—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –æ–Ω–ª–∞–π–Ω
–ú–µ–¥—Å–ø—Ä–∞–≤–∫–∞ 086-–£ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä—è–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
–û–±—Ä–∞–∑—Ü—ã –∑–∞—è–≤–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
–ü–æ–¥–∞—á–∞ –≤–æ–∑–º–æ–∂–Ω–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –±–∞–ª–ª–∞–º–∏ –£—Ä–§–£; –Ω–∏–∂–µ –º–∏–Ω–∏–º—É–º–∞ ‚Äî –≤–Ω–µ –∫–æ–Ω–∫—É—Ä—Å–∞
–ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É –≤—É–∑–∞–º–∏/–∏–Ω—Å—Ç–∏—Ç—É—Ç–∞–º–∏ –£—Ä–§–£ ‚Äî –ø–æ –∑–∞—è–≤–ª–µ–Ω–∏—é —Å –∫–æ–ø–∏–µ–π –∑–∞—á—ë—Ç–∫–∏ –∏–ª–∏ –∞–∫–∞–¥–µ–º—Å–ø—Ä–∞–≤–∫–æ–π, –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –∞–∫–∞–¥–µ–º—Ä–∞–∑–Ω–∏—Ü–µ–π
–ü—Ä–∏ –ø–æ–¥–∞—á–µ –Ω–∞ –±—é–¥–∂–µ—Ç –∏–ª–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ –ì–æ—Å—É—Å–ª—É–≥–∞—Ö

–ü—Ä–æ—á–µ–µ:
–û–±—â–µ–∂–∏—Ç–∏–µ ‚Äî –∏–Ω–æ–≥–æ—Ä–æ–¥–Ω–∏–º, –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É, –ø–ª–∞—Ç–Ω–æ–µ (–∫—Ä–æ–º–µ –ª—å–≥–æ—Ç–Ω–∏–∫–æ–≤)
–ï–ì–≠-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
–î–æ–ø–±–∞–ª–ª—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ –¥–ª—è –ø–æ–¥–∞—á–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
–û–ø–ª–∞—Ç–∞ ‚Äî –æ–±—ã—á–Ω–æ –ø–æ —Å–µ–º–µ—Å—Ç—Ä–∞–º, –≤–æ–∑–º–æ–∂–Ω–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∞
–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã ‚Äî –≤ –ø—Ä–∏–∫–∞–∑–µ –ø—Ä–∏—ë–º–∞
–ë–µ–∑ –ï–ì–≠ –ø–æ—Å—Ç—É–ø–∏—Ç—å –Ω–µ–ª—å–∑—è, –µ—Å–ª–∏ –Ω–µ—Ç –¥–∏–ø–ª–æ–º–∞ –°–ü–û
–°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤ –∑–∞—è–≤–ª–µ–Ω–∏–∏
–ù–µ –ø—Ä–æ—à–µ–¥—à–∏–µ –Ω–∞ –±—é–¥–∂–µ—Ç ‚Äî –º–æ–≥—É—Ç –∑–∞–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç
–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –¥–æ –∫–æ–Ω—Ü–∞ –ø—Ä–∏—ë–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
–û—Ç—Å—Ä–æ—á–∫–∞ –æ—Ç –∞—Ä–º–∏–∏ –Ω–µ –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≤–æ–∑–º–æ–∂–µ–Ω –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π –æ—Ç–ø—É—Å–∫
–†–µ–π—Ç–∏–Ω–≥ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å—É–º–º–µ –±–∞–ª–ª–æ–≤ –ø–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–µ–¥–º–µ—Ç–∞–º
–ö—É—Ä—Å—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–µ –≤–∫–ª—é—á—ë–Ω–Ω—ã–µ –≤ –ø—Ä–∏–∫–∞–∑ –£—Ä–§–£, –Ω–µ –¥–∞—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∞–ª–ª–æ–≤
–ó–∞–Ω—è—Ç–∏—è —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ —Å–ø–æ—Ä—Ç–∞
–í –£—Ä–§–£ –µ—Å—Ç—å –≤–æ–µ–Ω–Ω—ã–π —É—á–µ–±–Ω—ã–π —Ü–µ–Ω—Ç—Ä (–í–£–¶), –≥–¥–µ –º–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å—Å—è —Å —á–µ—Ç–≤—ë—Ä—Ç–æ–≥–æ —Å–µ–º–µ—Å—Ç—Ä–∞ –Ω–∞ –∫–∞—Ñ–µ–¥—Ä–µ –í–æ–∑–¥—É—à–Ω–æ-–∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö —Å–∏–ª, —Ç–∞–Ω–∫–æ–≤—ã—Ö –∏–ª–∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –≤–æ–π—Å–∫, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –∑–≤–∞–Ω–∏–µ –æ—Ñ–∏—Ü–µ—Ä–∞ –∑–∞–ø–∞—Å–∞
–ü—Ä–∞–≤–∏–ª–∞ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –∑–∞–∫–æ–Ω–µ ‚Ññ273-–§–ó –∏ –ø—Ä–∏–∫–∞–∑–µ –ú–∏–Ω–æ–±—Ä–Ω–∞—É–∫–∏ ‚Ññ821 –æ—Ç 27.11.2024
–ü–æ—Å—Ç—É–ø–∞—Ç—å –º–æ–≥—É—Ç –≥—Ä–∞–∂–¥–∞–Ω–µ –†–§, –∏–Ω–æ—Å—Ç—Ä–∞–Ω—Ü—ã –∏ –ª–∏—Ü–∞ –±–µ–∑ –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–∞ —Å –Ω—É–∂–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
–ü—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç—ã –æ —Å—Ä–µ–¥–Ω–µ–º –æ–±—â–µ–º, –°–ü–û, –í–û, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–∑–Ω–∞–Ω–Ω—ã–µ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è:
–ü—Ä–æ–≥—Ä–∞–º–º—ã –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π —Ä–∞–∑–º–µ—â–µ–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ –£—Ä–§–£
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ï–ì–≠ (2019‚Äì2025) –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –≤ 2025
–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–ª—è –°–ü–û = –ï–ì–≠, —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –æ–±—â–µ–º –∫–æ–Ω–∫—É—Ä—Å–µ
–ò–Ω–≤–∞–ª–∏–¥—ã, –∏–Ω–æ—Å—Ç—Ä–∞–Ω—Ü—ã –∏ –∏–Ω—ã–µ –ª—å–≥–æ—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–¥–∞—é—Ç –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ, —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ï–ì–≠ –∏–ª–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ)
–ó–∞–ø–∏—Å—å –Ω–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏—è ‚Äî —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –≥—Ä–∞—Ñ–∏–∫ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è —Å 1 –∏—é–Ω—è
–¶–µ–ª–µ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª –Ω–∞ —Å–∞–π—Ç–µ –£—Ä–§–£
–í–æ–µ–Ω–Ω—ã–π —É—á–µ–±–Ω—ã–π —Ü–µ–Ω—Ç—Ä: –∫–æ–Ω–∫—É—Ä—Å–Ω—ã–π –æ—Ç–±–æ—Ä –Ω–∞ 2 –∫—É—Ä—Å–µ, –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ ‚Äî –∑–≤–∞–Ω–∏–µ –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç–∞ –∑–∞–ø–∞—Å–∞, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ª—É–∂–±—ã –ø–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É
–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è –¥–ª—è –°–ü–û –∏ –∑–∞—Ä—É–±–µ–∂–Ω—ã—Ö –∞—Ç—Ç–µ—Å—Ç–∞—Ç–æ–≤: —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Å–µ—Ä–≤–∏—Å—ã, –ø–ª—é—Å –æ–¥–∏–Ω –∏–∑ —Ç—Ä—ë—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–º–∞—Ç–∞–Ω–∞–ª–∏–∑, –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏–ª–∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞)
–ù–∞—á–∏–Ω–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–º
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π, –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è —Ä–∞–∑ –≤ –¥–µ–Ω—å

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –º–∞–∫—Å–∏–º—É–º 10 –±–∞–ª–ª–æ–≤):
–ê–±–∏–ª–∏–º–ø–∏–∫—Å (–Ω–∞—Ü./–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π) ‚Äî 1 –±–∞–ª–ª
–í–æ–ª–æ–Ω—Ç—ë—Ä—Å—Ç–≤–æ (‚â•100 —á–∞—Å–æ–≤ –Ω–∞ dobro.ru) ‚Äî 1 –±–∞–ª–ª
–ì–¢–û (–∑–æ–ª–æ—Ç–æ–π –∑–Ω–∞–∫) ‚Äî 2 –±–∞–ª–ª–∞
–°–ø–æ—Ä—Ç (–Ω–µ–æ–ª–∏–º–ø–∏–π—Å–∫–∏–µ –ß–ú/–ß–ï) ‚Äî 2 –±–∞–ª–ª–∞
–ö—É—Ä—Å—ã ¬´–ó–æ–ª–æ—Ç–æ–µ —Å–µ—á–µ–Ω–∏–µ¬ª (¬´–ù–∞—É–∫–∞¬ª) ‚Äî 2 –±–∞–ª–ª–∞
–ú–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ / –ö–ú–° ‚Äî 3 –±–∞–ª–ª–∞
–û–ª–∏–º–ø–∏–π—Å–∫–∏–µ –∏–≥—Ä—ã, –ß–ú/–ß–ï (–æ–ª–∏–º–ø. –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞) ‚Äî 3 –±–∞–ª–ª–∞
–ü—Ä–∏–∑—ë—Ä ¬´–ë–æ–ª—å—à–æ–π –ø–µ—Ä–µ–º–µ–Ω—ã¬ª ‚Äî 3 –±–∞–ª–ª–∞
¬´–¢–µ—Å—Ç-–¥—Ä–∞–π–≤ –≤ –£—Ä–§–£¬ª (–æ—á–Ω—ã–π —ç—Ç–∞–ø) ‚Äî 4 –±–∞–ª–ª–∞
¬´–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è¬ª (–æ—á–Ω—ã–π —Ñ–∏–Ω–∞–ª) ‚Äî 4 –±–∞–ª–ª–∞, —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
–û–ª–∏–º–ø–∏–∞–¥–∞ ¬´–ò–∑—É–º—Ä—É–¥¬ª (—É—á–∞—Å—Ç–∏–µ) ‚Äî 4 –±–∞–ª–ª–∞, —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
–î–æ–ø. –±–∞–ª–ª—ã –∑–∞ —É—á–∞—Å—Ç–∏–µ –≤ –æ–ª–∏–º–ø–∏–∞–¥–µ ¬´–ò–∑—É–º—Ä—É–¥¬ª ‚Äî –¥–µ–π—Å—Ç–≤—É—é—Ç 2 –≥–æ–¥–∞, –ø—Ä–∏ –ø—Ä–∏–∑—ë—Ä—Å—Ç–≤–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è 4 –≥–æ–¥–∞
–î–æ–ø. –±–∞–ª–ª—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –∞—Ç—Ç–µ—Å—Ç–∞—Ç—ã (–∞—Ç—Ç–µ—Å—Ç–∞—Ç—ã —Å –æ—Ç–ª–∏—á–∏–µ–º –∏–∑ –°–ù–ì –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è)
–ê—Ç—Ç–µ—Å—Ç–∞—Ç —Å –æ—Ç–ª–∏—á–∏–µ–º (–∑–æ–ª–æ—Ç–∞—è –º–µ–¥–∞–ª—å)‚Äî 6 –±–∞–ª–ª–æ–≤
–í–æ–µ–Ω–Ω–∞—è —Å–ª—É–∂–±–∞ ‚Äî 10 –±–∞–ª–ª–æ–≤
–ü–æ —Ü–µ–ª–µ–≤–æ–º—É –æ–±—É—á–µ–Ω–∏—é ‚Äî –¥–æ 5 –±–∞–ª–ª–æ–≤ –∑–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞
–°—É–º–º–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –±–∞–ª–ª—ã –∑–∞ —Ä–∞–∑–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è

–û–±—É—á–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã:
–î–æ–≥–æ–≤–æ—Ä –Ω–∞ –ø–ª–∞—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –Ω–∞ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—è (–¥–ª—è –Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –≤—ã—á–µ—Ç–∞ –ª—É—á—à–µ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è)
–¶–µ–ª–µ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ ‚Äî –¥–æ–≥–æ–≤–æ—Ä —Å —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–º, –∑–∞—è–≤–∫–∞ —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∞–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ –±—é–¥–∂–µ—Ç –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (—Ä–∞–∑–Ω—ã–µ –∫–æ–Ω–∫—É—Ä—Å—ã)
–û–ø–ª–∞—Ç–∞ –≤–Ω–µ–±—é–¥–∂–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 2-4 —á–∞—Å—Ç–∏
–î–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞ –Ω—É–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã–π –æ—Ç–¥–µ–ª
–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è –Ω–∞ 5% –µ–∂–µ–≥–æ–¥–Ω–æ
–ü–µ—Ä–µ–≤–æ–¥ —Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –Ω–∞ –±—é–¥–∂–µ—Ç –≤–æ–∑–º–æ–∂–µ–Ω –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç –∏ —É—Å–ø–µ—à–Ω–æ–π —É—á—ë–±–µ
–û—Ç–∫–∞–∑ –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –¥–æ 5 –∞–≤–≥—É—Å—Ç–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –æ–±—â–µ–º –∫–æ–Ω–∫—É—Ä—Å–µ

–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏:
–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤ –ø—Ä–∏—ë–º–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏ –ø–æ –∞–¥—Ä–µ—Å—É: –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –ú–∏—Ä–∞, 19, –∏–ª–∏ —á–µ—Ä–µ–∑ —Ç–µ–ª–µ–≥—Ä–∞–º-–∫–∞–Ω–∞–ª –∏ —Å–æ—Ü—Å–µ—Ç–∏

–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –∫–≤–æ—Ç—ã:
–î–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø–æ —Ü–µ–ª–µ–≤–æ–º—É –æ–±—É—á–µ–Ω–∏—é –Ω—É–∂–Ω–æ –ø–æ–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏ –∏ –ø—Ä–æ–π—Ç–∏ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ
–ö–æ–Ω–∫—É—Ä—Å –Ω–∞ —Ü–µ–ª–µ–≤—ã–µ –º–µ—Å—Ç–∞ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω
–ü–µ—Ä–µ–≤–æ–¥ —Å –∫–æ–ª–ª–µ–¥–∂–∞ –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –°–ü–û –∏ –ø–æ—Å—Ç—É–ø–∏—Ç—å –Ω–∞ –ø–µ—Ä–≤—ã–π –∫—É—Ä—Å —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è
–ë–µ–∑ —ç–∫–∑–∞–º–µ–Ω–æ–≤ –ø–æ—Å—Ç—É–ø–∞—é—Ç –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏/–ø—Ä–∏–∑—ë—Ä—ã –í—Å–µ—Ä–æ—Å—Å–∏–π—Å–∫–æ–π –æ–ª–∏–º–ø–∏–∞–¥—ã, —á–ª–µ–Ω—ã —Å–±–æ—Ä–Ω—ã—Ö –†–§, —á–µ–º–ø–∏–æ–Ω—ã –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∏–≥—Ä
–û—Å–æ–±–∞—è –∫–≤–æ—Ç–∞ (‚â•10% –æ—Ç –ö–¶–ü) ‚Äî –¥–ª—è –ø–æ—Å—Ç—É–ø–∞—é—â–∏—Ö —Å –æ—Å–æ–±—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (–∏–Ω–≤–∞–ª–∏–¥—ã, —Å–∏—Ä–æ—Ç—ã –∏ –¥—Ä.)
–û—Ç–¥–µ–ª—å–Ω–∞—è –∫–≤–æ—Ç–∞ (‚â•10%) ‚Äî –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –ø—Ä–∏—ë–º–∞
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è ‚Äî —É —Å–æ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ–∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Å–∏—Ä–æ—Ç—ã, –∏–Ω–≤–∞–ª–∏–¥—ã –∏ –¥—Ä.)
–õ—å–≥–æ—Ç—ã –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –æ–ª–∏–º–ø–∏–∞–¥ –¥–µ–π—Å—Ç–≤—É—é—Ç 4 –≥–æ–¥–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –≤—É–∑–µ –∏ –Ω–∞ –æ–¥–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
–ü—Ä–∏ 75+ –±–∞–ª–ª–∞—Ö –ø–æ –ø—Ä–æ—Ñ–∏–ª—å–Ω–æ–º—É –ï–ì–≠ –∏–ª–∏ —ç–∫–∑–∞–º–µ–Ω—É –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å 100 –±–∞–ª–ª–æ–≤ –∑–∞ –ø—Ä–µ–¥–º–µ—Ç ‚Äî –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ–ª–∏–º–ø–∏–∞–¥–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
–ü—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ï–ì–≠ 2021‚Äì2025 –≥–æ–¥–æ–≤

–û–±—â–µ–∂–∏—Ç–∏–µ –≤ –ù–æ–≤–æ–∫–æ–ª—å—Ü–æ–≤–æ:
–°—Ç—É–¥–µ–Ω—Ç—ã –∂–∏–≤—É—Ç –≤ —Å—Ç—É–¥–∏—è—Ö –Ω–∞ –¥–≤–æ–∏—Ö: 2 –∫—Ä–æ–≤–∞—Ç–∏, —Ä–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞, —Å–≤–æ—è –≤–∞–Ω–Ω–∞—è –∏ –∫—É—Ö–Ω—è; –∫–æ—Ä–ø—É—Å–∞ —Å –ª–∏—Ñ—Ç–∞–º–∏ –∏ –∫–æ—Ä–∏–¥–æ—Ä–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
–ú–µ—Å—Ç–æ –≤ –æ–±—â–µ–∂–∏—Ç–∏–∏ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –Ω–∞ –≤–µ—Å—å —Å—Ä–æ–∫ –æ–±—É—á–µ–Ω–∏—è
–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Å—É–ø—Ä—É–≥–æ–≤ (–ø–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É –æ –±—Ä–∞–∫–µ)
–ó–∞—Å–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–æ–º –∏–ª–∏ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–º ‚Äî —á–µ—Ä–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–æ–≤
–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç ‚Äî —É—Ç–æ—á–Ω—è–µ—Ç—Å—è –≤ –¥–µ–∫–∞–Ω–∞—Ç–µ –∏–ª–∏ –∂–∏–ª–∏—â–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏

–°—Ä–æ–∫–∏ –ø–æ–¥–∞—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ 2025 –≥–æ–¥—É:
–ë—é–¥–∂–µ—Ç (–±–µ–∑ —ç–∫–∑–∞–º–µ–Ω–æ–≤): 20 –∏—é–Ω—è ‚Äì 25 –∏—é–ª—è
–ë—é–¥–∂–µ—Ç (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω—ã): –¥–æ 18 –∏—é–ª—è
–ü–ª–∞—Ç–Ω–æ–µ (–±–µ–∑ —ç–∫–∑–∞–º–µ–Ω–æ–≤): –¥–æ 5 —Å–µ–Ω—Ç—è–±—Ä—è
–ü–ª–∞—Ç–Ω–æ–µ (—Å —ç–∫–∑–∞–º–µ–Ω–∞–º–∏): –¥–æ 3 —Å–µ–Ω—Ç—è–±—Ä—è
–ò–Ω–æ—Å—Ç—Ä–∞–Ω—Ü—ã (–¥–æ–ø. –Ω–∞–±–æ—Ä): 15 —Å–µ–Ω—Ç—è–±—Ä—è ‚Äì 23 –æ–∫—Ç—è–±—Ä—è

–ö–æ–Ω–∫—É—Ä—Å –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:
–ö–æ–Ω–∫—É—Ä—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª—å–Ω–æ –ø–æ: —É—Ä–æ–≤–Ω—é –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, —Ñ–æ—Ä–º–µ –æ–±—É—á–µ–Ω–∏—è, –∏—Å—Ç–æ—á–Ω–∏–∫—É —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–≤–æ—Ç–∞–º
–ú–æ–∂–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –∫–æ–Ω–∫—É—Ä—Å–µ –Ω–∞ 5 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
–ü—Ä–∏ –ø–æ–¥–∞—á–µ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ –∫–∞–∂–¥–æ–π –∫–≤–æ—Ç–µ (–æ—Å–æ–±–∞—è, —Ü–µ–ª–µ–≤–∞—è, –æ—Å–Ω–æ–≤–Ω–∞—è) –∏ –æ–¥–∏–Ω –æ–±—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ –ø–ª–∞—Ç–Ω—ã–º –º–µ—Å—Ç–∞–º (1 ‚Äî –Ω–∞–∏–≤—ã—Å—à–∏–π)
–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –º–æ–∂–Ω–æ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏—ë–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –æ—Ñ–æ—Ä–º–∏–≤ –Ω–æ–≤—ã–π ¬´–õ–∏—Å—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∫–æ–Ω–∫—É—Ä—Å–∞¬ª

–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –≥—Ä–∞–∂–¥–∞–Ω–µ
–ü–æ—Å—Ç—É–ø–∞—é—Ç: –ø–æ –∫–≤–æ—Ç–µ –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –†–§, –ø–æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º –¥–æ–≥–æ–≤–æ—Ä–∞–º, –∫–∞–∫ —Å–æ–æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏, –Ω–∞ –ø–ª–∞—Ç–Ω–æ–π –æ—Å–Ω–æ–≤–µ
–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –ø–∞—Å–ø–æ—Ä—Ç —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º, –¥–æ–∫—É–º–µ–Ω—Ç –æ–± –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ + –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ, —Ñ–æ—Ç–æ 3√ó4, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –ú–∏–Ω–æ–±—Ä–Ω–∞—É–∫–∏, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ –∑–Ω–∞–Ω–∏–∏ —è–∑—ã–∫–∞ (B1)
–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ: –ø–æ –∫–≤–æ—Ç–µ ‚Äî –±–µ–∑ —ç–∫–∑–∞–º–µ–Ω–æ–≤, –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º ‚Äî 2 —ç–∫–∑–∞–º–µ–Ω–∞ (–ø—Ä–µ–¥–º–µ—Ç + —Ä—É—Å—Å–∫–∏–π), –Ω–∞ –ø–ª–∞—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ ‚Äî –ø–æ —Ç–µ–º –∂–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
–°—Ä–æ–∫–∏: –ø–æ –∫–≤–æ—Ç–µ ‚Äî –ø–æ –≥—Ä–∞—Ñ–∏–∫—É –ú–∏–Ω–æ–±—Ä–Ω–∞—É–∫–∏, –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º ‚Äî —Å 1 –ø–æ 6 –∞–≤–≥—É—Å—Ç–∞, –Ω–∞ –ø–ª–∞—Ç–Ω–æ–µ ‚Äî –¥–æ 8 —Å–µ–Ω—Ç—è–±—Ä—è
–ë–µ–ª–æ—Ä—É—Å—ã: –ø–æ –º–µ–∂–ø—Ä–∞–≤—Å–æ–≥–ª–∞—à–µ–Ω–∏—é, –±–µ–∑ –ø—Ä–∏–∑–Ω–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¶–¢ –≤–º–µ—Å—Ç–æ –ï–ì–≠, —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∫–æ–Ω–∫—É—Ä—Å–µ –Ω–∞—Ä–∞–≤–Ω–µ —Å —Ä–æ—Å—Å–∏—è–Ω–∞–º–∏
–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π –∞—Ç—Ç–µ—Å—Ç–∞—Ç: —Ç—Ä–µ–±—É–µ—Ç –Ω–æ—Å—Ç—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫—Ä–æ–º–µ –°–ù–ì –∏ –∫–≤–æ—Ç—ã –ú–∏–Ω–æ–±—Ä–Ω–∞—É–∫–∏)'''
                },
                {
                    "role": "user",
                    "text": question
                }
            ]
        }

        response = requests.post(
            "https://llm.api.cloud.yandex.net/foundationModels/v1/completion",
            headers={
                "Authorization": f"Bearer {IAM_TOKEN}",
                "Content-Type": "application/json"
            },
            json=prompt
        ).json()

        return response['result']['alternatives'][0]['message']['text']
    except Exception as e:
        logger.error(f"Yandex API error: {e}")
        return "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

async def send_delayed_response(chat_id: int, message_id: int, topic_id: int):
    """–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π"""
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –ª–∏ —É–∂–µ –∞–¥–º–∏–Ω
        result = db_execute(
            "SELECT admin_replied FROM questions WHERE msg_id=?",
            (message_id,)
        )
        
        if result and result[0][0]:  # –ï—Å–ª–∏ –∞–¥–º–∏–Ω —É–∂–µ –æ—Ç–≤–µ—Ç–∏–ª
            logger.info(f"Admin already replied to message {message_id}")
            return

        # –ü–æ–ª—É—á–∞–µ–º –≤–æ–ø—Ä–æ—Å –∏–∑ –±–∞–∑—ã
        question = db_execute(
            "SELECT question FROM questions WHERE msg_id=? AND answered=0",
            (message_id,)
        )
        
        if not question:
            return

        # –ñ–¥–µ–º —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
        await asyncio.sleep(CONFIG['response_delay'] * 60)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—â–µ —Ä–∞–∑ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        result = db_execute(
            "SELECT admin_replied FROM questions WHERE msg_id=?",
            (message_id,)
        )
        if result and result[0][0]:
            return

        # –ü–æ–ª—É—á–∞–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
        answer = get_answer(question[0][0])
        await bot.send_message(
            chat_id=chat_id,
            message_thread_id=topic_id,
            text=answer,
            reply_to_message_id=message_id
        )

        # –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ—Ç–≤–µ—á–µ–Ω–Ω—ã–π
        db_execute(
            "UPDATE questions SET answered=1 WHERE msg_id=?",
            (message_id,),
            commit=True
        )
    except Exception as e:
        logger.error(f"Response error: {e}")

def db_execute(query: str, params=(), commit: bool = False):
    """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –∑–∞–ø—Ä–æ—Å–∞"""
    try:
        with closing(sqlite3.connect('questions.db')) as conn:
            conn.execute("PRAGMA foreign_keys = ON")
            c = conn.cursor()
            c.execute(query, params)
            if commit:
                conn.commit()
            return c.fetchall()
    except sqlite3.Error as e:
        logger.error(f"Database error: {e}")
        return None

async def check_user_limit(user_id: int) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –≤–æ–ø—Ä–æ—Å–æ–≤"""
    try:
        result = db_execute(
            "SELECT question_count FROM users WHERE user_id=?",
            (user_id,)
        )
        return not (result and result[0][0] >= CONFIG['max_questions_per_user'])
    except Exception as e:
        logger.error(f"Limit check error: {e}")
        return True

def update_user_limit(user_id: int):
    """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤"""
    try:
        db_execute(
            '''INSERT OR REPLACE INTO users 
            (user_id, last_question_time, question_count)
            VALUES (?, ?, COALESCE(
                (SELECT question_count FROM users WHERE user_id=?) + 1, 1))''',
            (user_id, datetime.now(), user_id),
            commit=True
        )
    except Exception as e:
        logger.error(f"Limit update error: {e}")

def cleanup_database():
    """–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π"""
    try:
        db_execute(
            "DELETE FROM questions WHERE timestamp < ?",
            (datetime.now() - timedelta(days=7),),
            commit=True
        )
        logger.info("Database cleanup completed")
    except Exception as e:
        logger.error(f"Cleanup error: {e}")

@dp.message_handler(content_types=types.ContentTypes.TEXT)
async def handle_message(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–∞—Ç –∏ —Ç–µ–º—É
        #if message.chat.id != CONFIG['allowed_chat_id']:
            #return
            
        topic_id = getattr(message, 'message_thread_id', 1)
        #if topic_id != CONFIG['allowed_topic_id']:
            #return

        # –ï—Å–ª–∏ —ç—Ç–æ –æ—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
        if message.reply_to_message:
            if await is_admin(message.chat.id, message.from_user.id):
                # –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –∞–¥–º–∏–Ω –æ—Ç–≤–µ—Ç–∏–ª
                db_execute(
                    "UPDATE questions SET admin_replied=1 WHERE msg_id=?",
                    (message.reply_to_message.message_id,),
                    commit=True
                )
                logger.info(f"Admin replied to message {message.reply_to_message.message_id}")
                return

        # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–æ–≤
        if message.from_user.is_bot:
            return

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å (–∑–Ω–∞–∫ "?")
        if '?' not in message.text:
            logger.info(f"Ignoring message without question mark: {message.text}")
            return

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç
        if not await check_user_limit(message.from_user.id):
            await message.reply(
                f"üö´ –õ–∏–º–∏—Ç ({CONFIG['max_questions_per_user']} –≤–æ–ø—Ä–æ—Å–æ–≤/—á–∞—Å) –∏—Å—á–µ—Ä–ø–∞–Ω!"
            )
            return

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–æ–ø—Ä–æ—Å
        db_execute(
            '''INSERT INTO questions 
            (msg_id, chat_id, user_id, question, timestamp, topic_id)
            VALUES (?, ?, ?, ?, ?, ?)''',
            (
                message.message_id,
                message.chat.id,
                message.from_user.id,
                message.text,
                datetime.now(),
                topic_id
            ),
            commit=True
        )
        
        update_user_limit(message.from_user.id)

        # –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
        asyncio.create_task(
            send_delayed_response(
                chat_id=message.chat.id,
                message_id=message.message_id,
                topic_id=topic_id
            )
        )

    except Exception as e:
        logger.error(f"Message handling error: {e}")

async def is_admin(chat_id: int, user_id: int) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"""
    try:
        admins = await bot.get_chat_administrators(chat_id)
        return any(admin.user.id == user_id for admin in admins)
    except Exception as e:
        logger.error(f"Admin check error: {e}")
        return False

async def on_startup(dp):
    """–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞"""
    scheduler.start()
    scheduler.add_job(
        cleanup_database,
        'interval',
        hours=CONFIG['cleanup_interval']
    )
    
    try:
        chat = await bot.get_chat(CONFIG['allowed_chat_id'])
        logger.info(f"–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —á–∞—Ç–µ: {chat.title} (ID: {chat.id})")
        logger.info(f"–†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ç–µ–º–µ —Å ID: {CONFIG['allowed_topic_id']}")
    except Exception as e:
        logger.error(f"Startup error: {e}")
        raise

if __name__ == "__main__":
    try:
        executor.start_polling(
            dp,
            skip_updates=True,
            on_startup=on_startup
        )
    except Exception as e:
        logger.error(f"Critical error: {e}")
    finally:
        scheduler.shutdown()
        logger.info("–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
